<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Pro Max - Anti-Quota Stable</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --yt-red: #ff0000; --bg: #0f0f0f; }
        body { font-family: 'Roboto', sans-serif; background: var(--bg); color: white; margin: 0; }
        .v-card { cursor: pointer; transition: transform 0.2s; }
        .v-card:hover { transform: scale(1.02); }
        .thumb-wrap { position: relative; aspect-ratio: 16/9; border-radius: 12px; overflow: hidden; background: #222; }
        .thumb-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .badge { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); padding: 2px 6px; border-radius: 4px; font-size: 11px; }
        .quota-warning { background: #b91c1c; color: white; padding: 10px; text-align: center; font-weight: bold; font-size: 14px; display: none; }
        .cache-info { background: #1e3a8a; color: white; padding: 4px; text-align: center; font-size: 11px; }
        
        /* Skeleton Loading */
        .skel { background: linear-gradient(90deg, #1a1a1a 25%, #252525 50%, #1a1a1a 75%); background-size: 200% 100%; animation: load 1.5s infinite; }
        @keyframes load { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
</head>
<body>

    <div id="quota-alert" class="quota-warning">‚ö†Ô∏è G√úNL√úK API KOTANIZ DOLDU! ≈ûu an eski (√∂nbellek) verileri g√∂r√ºyorsunuz.</div>
    <div id="cache-log"></div>

    <nav class="fixed top-0 w-full bg-[#0f0f0f] border-b border-[#272727] h-14 flex items-center justify-between px-4 z-[1000]">
        <div class="flex items-center gap-4">
            <span class="text-2xl cursor-pointer">‚ò∞</span>
            <div class="flex items-center gap-1 cursor-pointer" onclick="location.reload()">
                <span class="text-red-600 text-3xl font-bold">‚ñ∂</span>
                <span class="text-xl font-bold tracking-tighter">YouTube</span>
            </div>
        </div>
        <div class="flex flex-1 max-w-[600px] mx-10">
            <input id="qInput" type="text" placeholder="Ara" class="w-full bg-[#121212] border border-[#303030] rounded-l-full px-5 py-2 outline-none focus:border-blue-500">
            <button onclick="engine.search()" class="bg-[#222] border border-[#303030] border-l-0 px-6 rounded-r-full hover:bg-[#333]">üîç</button>
        </div>
        <div class="w-8 h-8 bg-purple-700 rounded-full flex items-center justify-center font-bold text-xs shadow-lg">AGA</div>
    </nav>

    <div class="flex pt-14">
        <aside class="w-64 fixed left-0 h-screen p-3 border-r border-[#272727] hidden lg:block">
            <div class="p-3 bg-[#272727] rounded-xl font-bold mb-4">üè† Ana Sayfa</div>
            <div class="p-3 hover:bg-[#272727] rounded-xl cursor-pointer mb-2">üéûÔ∏è Shorts</div>
            <div class="p-3 hover:bg-[#272727] rounded-xl cursor-pointer">üë• Abonelikler</div>
        </aside>

        <main class="flex-1 lg:ml-64 p-6">
            <div id="main-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-6 gap-y-10">
                </div>
        </main>
    </div>

    <script>
        // √ñNEMLƒ∞: Eƒüer bu key de hata verirse Google Cloud'dan yenisini alƒ±p buraya koy.
        const API_KEY = 'AIzaSyDkaygARzpXfIXlozjyppLdXsPoE-mq1gg'; 

        const engine = {
            // VERƒ∞Yƒ∞ √ñNCE CACHE'DEN KONTROL ET
            async fetchData(query) {
                const cacheKey = `yt_cache_${query.replace(/\s/g, '_')}`;
                const cached = localStorage.getItem(cacheKey);

                if (cached) {
                    const parsed = JSON.parse(cached);
                    const isExpired = (Date.now() - parsed.timestamp) > 3600000; // 1 saatlik √∂m√ºr

                    if (!isExpired) {
                        document.getElementById('cache-log').innerHTML = `<div class="cache-info">‚ÑπÔ∏è Veriler yerel hafƒ±zadan y√ºklendi. (API Kotasƒ± harcanmadƒ±)</div>`;
                        return parsed.data;
                    }
                }

                // Cache yoksa veya eskiyse API'ye git
                try {
                    const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=24&q=${query}&type=video&regionCode=TR&key=${API_KEY}`);
                    
                    if (!res.ok) {
                        if (res.status === 403) document.getElementById('quota-alert').style.display = 'block';
                        throw new Error("API Hatasƒ±");
                    }

                    const data = await res.json();
                    
                    // Hafƒ±zaya At
                    localStorage.setItem(cacheKey, JSON.stringify({
                        timestamp: Date.now(),
                        data: data
                    }));

                    document.getElementById('cache-log').innerHTML = "";
                    return data;

                } catch (err) {
                    console.error("Hata:", err);
                    // Hata durumunda (kota bitmesi gibi) eƒüer eski veri varsa onu d√∂nd√ºr
                    if (cached) return JSON.parse(cached).data;
                    return null;
                }
            },

            async search() {
                const q = document.getElementById('qInput').value || 'pop√ºler T√ºrkiye videolarƒ±';
                const grid = document.getElementById('main-grid');
                
                // Skeleton Loader G√∂ster
                grid.innerHTML = Array(8).fill('<div class="h-60 skel rounded-xl"></div>').join('');

                const data = await this.fetchData(q);

                if (!data || !data.items) {
                    grid.innerHTML = `<p class="col-span-full text-center text-gray-500 mt-20">Veri √ßekilemedi. L√ºtfen API anahtarƒ±nƒ± kontrol et veya sonra tekrar dene.</p>`;
                    return;
                }

                grid.innerHTML = data.items.map(v => `
                    <div class="v-card group" onclick="window.open('https://youtube.com/watch?v=${v.id.videoId}', '_blank')">
                        <div class="thumb-wrap">
                            <img src="${v.snippet.thumbnails.high.url}" loading="lazy">
                            <span class="badge">12:40</span>
                        </div>
                        <div class="flex gap-3 mt-4">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-tr from-gray-700 to-gray-800 flex-shrink-0"></div>
                            <div>
                                <h3 class="text-sm font-bold line-clamp-2 group-hover:text-red-500 transition">${v.snippet.title}</h3>
                                <p class="text-xs text-gray-400 mt-1">${v.snippet.channelTitle}</p>
                                <p class="text-[11px] text-gray-500">1.2 Mn izlenme ‚Ä¢ 5 saat √∂nce</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        };

        // Uygulamayƒ± Ba≈ülat
        engine.search();

        // Enter tu≈üu dinleyici
        document.getElementById('qInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') engine.search();
        });
    </script>
</body>
</html>
