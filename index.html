<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Pro - Dual Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f0f0f; color: white; font-family: 'Roboto', sans-serif; }
        .v-card img { aspect-ratio: 16/9; border-radius: 12px; object-fit: cover; transition: 0.3s; }
        .v-card:hover img { border-radius: 0; transform: scale(1.02); }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .active-engine { background-color: #22c55e; box-shadow: 0 0 10px #22c55e; }
        .dead-engine { background-color: #ef4444; text-decoration: line-through; opacity: 0.5; }
    </style>
</head>
<body>

    <div class="bg-[#1a1a1a] p-2 flex items-center justify-center gap-6 border-b border-[#272727] text-[11px] font-bold">
        <div id="engine1" class="flex items-center"><span class="status-dot active-engine"></span> MOTOR 1 (Aktif)</div>
        <div id="engine2" class="flex items-center"><span class="status-dot bg-gray-600"></span> MOTOR 2 (Beklemede)</div>
    </div>

    <nav class="sticky top-0 bg-[#0f0f0f] z-50 p-4 flex items-center justify-between border-b border-[#272727]">
        <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
            <span class="text-red-600 text-3xl font-bold">‚ñ∂</span>
            <span class="text-xl font-bold tracking-tighter">YouTube</span>
        </div>
        <div class="flex w-1/2 max-w-[600px]">
            <input id="searchInput" type="text" placeholder="Ara..." class="w-full bg-[#121212] border border-[#303030] rounded-l-full px-5 py-2 outline-none focus:border-blue-500">
            <button onclick="app.search()" class="bg-[#222] border border-[#303030] border-l-0 px-6 rounded-r-full hover:bg-[#333]">üîç</button>
        </div>
        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-xs">TR</div>
    </nav>

    <main class="p-6">
        <div id="videoGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-6 gap-y-10">
            </div>
    </main>

    <script>
        // VERDƒ∞ƒûƒ∞N 2 ANAHTAR BURADA
        const API_POOL = [
            'AIzaSyDkaygARzpXfIXlozjyppLdXsPoE-mq1gg',
            'AIzaSyDtKNweE8UM8kmuyVkIZgv9FjpS0kHB_04'
        ];

        const app = {
            currentKeyIdx: 0,
            
            // API Durumunu G√∂rselle≈ütir
            updateUI() {
                const e1 = document.getElementById('engine1');
                const e2 = document.getElementById('engine2');
                
                if(this.currentKeyIdx === 0) {
                    e1.innerHTML = '<span class="status-dot active-engine"></span> MOTOR 1 (Aktif)';
                } else {
                    e1.classList.add('dead-engine');
                    e1.innerHTML = '<span class="status-dot dead-engine"></span> MOTOR 1 (Bƒ∞TTƒ∞)';
                    e2.innerHTML = '<span class="status-dot active-engine"></span> MOTOR 2 (Aktif)';
                }
            },

            async fetchData(query) {
                // √ñnce tarayƒ±cƒ± hafƒ±zasƒ±na (Cache) bak
                const cacheKey = `yt_cache_${query.toLowerCase()}`;
                const cached = localStorage.getItem(cacheKey);
                if (cached) {
                    const parsed = JSON.parse(cached);
                    if (Date.now() - parsed.time < 86400000) { // 24 saat sakla
                        console.log("Hafƒ±zadan getirildi.");
                        return parsed.data;
                    }
                }

                return await this.tryFetch(query);
            },

            async tryFetch(query) {
                const key = API_POOL[this.currentKeyIdx];
                this.updateUI();

                try {
                    const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=24&q=${query}&type=video&regionCode=TR&key=${key}`);
                    
                    if (res.status === 403) { // KOTA DOLDU
                        if (this.currentKeyIdx < API_POOL.length - 1) {
                            console.warn("Motor 1 bitti, Motor 2'ye ge√ßiliyor...");
                            this.currentKeyIdx++;
                            return await this.tryFetch(query); // Diƒüer key ile tekrar dene
                        } else {
                            alert("T√ºm API kotalarƒ± doldu! Yarƒ±n tekrar gel.");
                            return null;
                        }
                    }

                    const data = await res.json();
                    // Hafƒ±zaya kaydet
                    localStorage.setItem(`yt_cache_${query.toLowerCase()}`, JSON.stringify({
                        time: Date.now(),
                        data: data
                    }));
                    return data;

                } catch (err) {
                    console.error("Hata:", err);
                    return null;
                }
            },

            async search() {
                const q = document.getElementById('searchInput').value || 'trend videolar t√ºrkiye';
                const grid = document.getElementById('videoGrid');
                grid.innerHTML = '<p class="text-center col-span-full">Y√ºkleniyor...</p>';

                const data = await this.fetchData(q);
                if (!data || !data.items) return;

                grid.innerHTML = data.items.map(v => `
                    <div class="v-card cursor-pointer" onclick="window.open('https://youtube.com/watch?v=${v.id.videoId}')">
                        <img src="${v.snippet.thumbnails.high.url}" class="w-full">
                        <div class="flex gap-3 mt-3">
                            <div class="w-9 h-9 bg-gray-700 rounded-full flex-shrink-0"></div>
                            <div>
                                <h3 class="text-sm font-bold line-clamp-2">${v.snippet.title}</h3>
                                <p class="text-xs text-gray-400 mt-1">${v.snippet.channelTitle}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        };

        // Klavye ile arama
        document.getElementById('searchInput').addEventListener('keypress', (e) => e.key === 'Enter' && app.search());

        // Ba≈ülat
        app.search();
    </script>
</body>
</html>
