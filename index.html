<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Pro - Sync & Airdrop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #000; margin: 0; color: white; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        #feed { height: 100vh; overflow-y: scroll; scroll-snap-type: y mandatory; scrollbar-width: none; }
        #feed::-webkit-scrollbar { display: none; }
        .video-wrapper { height: 100vh; scroll-snap-align: start; display: flex; justify-content: center; align-items: center; position: relative; }
        .container-9-16 { height: 100vh; width: calc(100vh * 9 / 16); position: relative; background: #000; }
        video { width: 100%; height: 100%; object-fit: cover; }
        
        /* Üst Sekmeler */
        .nav-tabs { position: fixed; top: 0; left: 0; width: 100%; display: flex; justify-content: center; gap: 30px; padding: 20px; z-index: 100; background: linear-gradient(to bottom, rgba(0,0,0,0.7), transparent); }
        .tab-item { cursor: pointer; font-weight: bold; opacity: 0.6; transition: 0.3s; border-bottom: 2px solid transparent; padding-bottom: 5px; }
        .tab-item.active { opacity: 1; border-bottom: 2px solid white; }
        .tab-item:hover { opacity: 1; }

        /* Sağ Menü */
        .side-menu { position: absolute; right: 15px; bottom: 100px; display: flex; flex-direction: column; gap: 20px; align-items: center; z-index: 50; }
        .icon-circle { background: rgba(40, 40, 40, 0.8); width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-bottom: 4px; cursor: pointer; }
        
        /* Sabit Ses Butonu */
        .sound-btn { position: absolute; top: 80px; right: 25px; z-index: 100; cursor: pointer; background: rgba(0,0,0,0.5); padding: 12px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.2); }
    </style>
</head>
<body>

    <div class="nav-tabs">
        <div class="tab-item active" onclick="switchTab('main')">Ana Sayfa</div>
        <div class="tab-item" onclick="switchTab('airdrop')">Airdrop <i class="fas fa-parachute-box ml-1 text-yellow-400"></i></div>
    </div>

    <div class="sound-btn" onclick="toggleMute()">
        <i id="mute-icon" class="fas fa-volume-mute text-xl w-6 text-center"></i>
    </div>

    <div id="feed"></div>

    <script>
        // API ve Video Tanımları
        const TIKTOK_API = { clientKey: "aw01joj8wk4rnll9" };
        const videoList = ['reels1.mp4', 'reels2.mp4', 'reels3.mp4', 'reels4.mp4', 'reels5.mp4'];
        
        // SES DURUMU (Global Değişken)
        let isGlobalMuted = true;

        const feed = document.getElementById('feed');

        function shuffle(array) { return array.sort(() => Math.random() - 0.5); }

        function createVideo(fileName) {
            const wrapper = document.createElement('div');
            wrapper.className = 'video-wrapper';
            wrapper.innerHTML = `
                <div class="container-9-16">
                    <video loop playsinline class="tk-video" src="${fileName}"></video>
                    <div class="side-menu">
                        <div class="icon-circle"><i class="fas fa-heart text-red-500"></i></div>
                        <div class="icon-circle"><i class="fas fa-comment-dots"></i></div>
                        <div class="icon-circle"><i class="fas fa-share"></i></div>
                    </div>
                    <div class="absolute bottom-8 left-5 right-10">
                        <h4 class="font-bold">@dev_user</h4>
                        <p class="text-sm opacity-90 italic">TikTok API: ${TIKTOK_API.clientKey}</p>
                    </div>
                </div>
            `;
            feed.appendChild(wrapper);
            const videoElement = wrapper.querySelector('video');
            
            // Yeni video eklenirken anlık ses durumunu zorla uygula
            videoElement.muted = isGlobalMuted;
            observer.observe(videoElement);
        }

        function toggleMute() {
            isGlobalMuted = !isGlobalMuted;
            const icon = document.getElementById('mute-icon');
            icon.className = isGlobalMuted ? "fas fa-volume-mute text-xl w-6 text-center" : "fas fa-volume-up text-xl w-6 text-center";
            
            // Tüm videoların sesini anında güncelle
            document.querySelectorAll('.tk-video').forEach(v => {
                v.muted = isGlobalMuted;
            });
        }

        function switchTab(tab) {
            if(tab === 'airdrop') {
                alert("Airdrop sekmesine hoş geldin! Yakında buraya cüzdan bağlama eklenecek.");
            }
            document.querySelectorAll('.tab-item').forEach(el => el.classList.toggle('active', el.innerText.toLowerCase().includes(tab)));
        }

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const video = entry.target;
                if (entry.isIntersecting) {
                    // Oynatmadan hemen önce ses durumunu tekrar kontrol et (Tarayıcı hatasını önler)
                    video.muted = isGlobalMuted;
                    video.play().catch(e => console.log("Etkileşim bekleniyor..."));
                    
                    if (video === feed.lastElementChild.querySelector('video')) {
                        loadMore();
                    }
                } else {
                    video.pause();
                }
            });
        }, { threshold: 0.8 });

        function loadMore() {
            shuffle([...videoList]).forEach(file => createVideo(file));
        }

        // Başlat
        loadMore();

        // Tarayıcı Kilidini Kırmak İçin: İlk tıklamada her şeyi senkronize et
        window.addEventListener('click', () => {
            document.querySelectorAll('.tk-video').forEach(v => v.muted = isGlobalMuted);
        }, { once: true });
    </script>
</body>
</html>
