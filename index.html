<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube AGA - Pro Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --yt-bg: #0f0f0f; --yt-card: #1e1e1e; }
        body { background: var(--yt-bg); color: white; font-family: 'Roboto', sans-serif; }
        .v-card img { aspect-ratio: 16/9; border-radius: 12px; object-fit: cover; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .v-card:hover img { border-radius: 0; transform: scale(1.05); }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        #loader { display: none; }
        .shimmer { background: linear-gradient(90deg, #1a1a1a 25%, #252525 50%, #1a1a1a 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        #video-modal { display: none; backdrop-filter: blur(10px); }
    </style>
</head>
<body>

    <nav class="fixed top-0 w-full bg-[#0f0f0f]/95 border-b border-[#272727] h-16 flex items-center justify-between px-6 z-50">
        <div class="flex items-center gap-4 cursor-pointer" onclick="location.reload()">
            <i class="fab fa-youtube text-red-600 text-3xl"></i>
            <span class="text-xl font-bold tracking-tighter">YouTube Pro</span>
        </div>
        
        <div class="flex flex-1 max-w-[700px] mx-8">
            <div class="flex w-full bg-[#121212] border border-[#303030] rounded-full px-4 items-center focus-within:border-blue-500 transition">
                <input id="search" type="text" placeholder="Arat bakalım..." class="bg-transparent w-full py-2 outline-none text-sm">
                <button onclick="app.runSearch()" class="pl-4 hover:text-red-500"><i class="fas fa-search"></i></button>
            </div>
        </div>

        <div class="flex items-center gap-4">
            <i class="fas fa-video text-xl cursor-pointer hover:text-gray-400"></i>
            <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center font-bold text-xs">A</div>
        </div>
    </nav>

    <main class="pt-24 px-6">
        <div id="skeleton-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <div class="h-64 shimmer rounded-xl"></div>
            <div class="h-64 shimmer rounded-xl"></div>
            <div class="h-64 shimmer rounded-xl"></div>
            <div class="h-64 shimmer rounded-xl"></div>
        </div>

        <div id="videoGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-6 gap-y-10"></div>
    </main>

    <div id="video-modal" class="fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="bg-black w-full max-w-5xl rounded-2xl overflow-hidden shadow-2xl">
            <div class="flex justify-between items-center p-4 bg-[#1a1a1a]">
                <h3 id="m-title" class="text-sm font-bold truncate pr-4">Video Oynatılıyor</h3>
                <button onclick="app.closePlayer()" class="text-white hover:text-red-500 text-2xl">&times;</button>
            </div>
            <div class="aspect-video bg-black">
                <iframe id="m-frame" class="w-full h-full" src="" frameborder="0" allowfullscreen allow="autoplay"></iframe>
            </div>
        </div>
    </div>

    <script>
        const app = {
            // Piped API Global Instance (En hızlı sunucu)
            api: 'https://pipedapi.kavin.rocks',

            async init() {
                this.fetchTrending();
                document.getElementById('search').addEventListener('keypress', (e) => e.key === 'Enter' && this.runSearch());
            },

            async fetchTrending() {
                try {
                    const res = await fetch(`${this.api}/trending?region=TR`);
                    const data = await res.json();
                    this.render(data);
                } catch (err) {
                    console.error("Hata:", err);
                    this.api = 'https://pipedapi.lunar.icu'; // Sunucu patlarsa yedeğe geç
                    this.fetchTrending();
                }
            },

            async runSearch() {
                const q = document.getElementById('search').value;
                if (!q) return;
                
                document.getElementById('videoGrid').innerHTML = '';
                document.getElementById('skeleton-grid').style.display = 'grid';

                try {
                    const res = await fetch(`${this.api}/search?q=${encodeURIComponent(q)}&filter=videos`);
                    const data = await res.json();
                    this.render(data.items);
                } catch (err) {
                    alert("Arama motoru meşgul, tekrar dene!");
                }
            },

            render(videos) {
                document.getElementById('skeleton-grid').style.display = 'none';
                const grid = document.getElementById('videoGrid');
                
                grid.innerHTML = videos.map(v => `
                    <div class="v-card group cursor-pointer" onclick="app.play('${v.url.split('=')[1]}', '${v.title.replace(/'/g, "")}')">
                        <div class="relative overflow-hidden rounded-xl">
                            <img src="${v.thumbnail}" class="w-full" loading="lazy">
                            <span class="absolute bottom-2 right-2 bg-black/80 px-2 py-1 rounded text-xs font-bold">
                                ${v.duration ? Math.floor(v.duration / 60) + ":" + (v.duration % 60).toString().padStart(2, '0') : 'LIVE'}
                            </span>
                        </div>
                        <div class="flex gap-3 mt-4">
                            <img src="${v.uploaderAvatar || 'https://via.placeholder.com/40'}" class="w-10 h-10 rounded-full flex-shrink-0">
                            <div>
                                <h3 class="text-sm font-bold line-clamp-2 group-hover:text-red-500 transition">${v.title}</h3>
                                <p class="text-xs text-gray-400 mt-1">${v.uploaderName}</p>
                                <p class="text-[11px] text-gray-500 mt-0.5">${(v.views / 1000).toFixed(1)}B izlenme • ${v.uploadedDate || 'Yeni'}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            },

            play(id, title) {
                const modal = document.getElementById('video-modal');
                const frame = document.getElementById('m-frame');
                document.getElementById('m-title').innerText = title;
                
                // YouTube'un kendi embed'ini kullanıyoruz ama API anahtarı istemez
                frame.src = `https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            },

            closePlayer() {
                const modal = document.getElementById('video-modal');
                document.getElementById('m-frame').src = "";
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        };

        app.init();
    </script>
</body>
</html>
