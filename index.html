<style>
    /* Cüzdan Giriş Alanı Tasarımı */
    .wallet-input {
        background: #000;
        border: 2px solid #222;
        border-radius: 18px;
        padding: 16px;
        color: #fff;
        width: 100%;
        font-family: 'Inter', sans-serif;
        font-weight: 700;
        font-size: 14px;
        outline: none;
        transition: 0.3s;
        text-align: center;
    }
    .wallet-input:focus { border-color: #fff; }
    
    .save-btn {
        background: #fff;
        color: #000;
        font-weight: 900;
        padding: 18px;
        border-radius: 20px;
        width: 100%;
        margin-top: 15px;
        text-transform: uppercase;
        font-size: 13px;
    }
    
    .wallet-info-box {
        background: #111;
        border: 1px solid #1a1a1a;
        padding: 20px;
        border-radius: 28px;
        text-align: center;
        width: 100%;
    }
</style>

<div id="airdrop" class="page">
    <h2 class="text-4xl font-black italic uppercase mt-16 mb-2 text-center">Airdrop</h2>
    <p class="text-zinc-500 font-bold text-sm mb-12 text-center px-6">Submit your TON wallet address to qualify for the $KOALA drop.</p>

    <div id="wallet-form" class="space-y-4">
        <div class="px-2">
            <input type="text" id="wallet-addr-input" class="wallet-input" placeholder="UQAz... (TON Address)" spellcheck="false">
        </div>
        <button class="save-btn" onclick="saveWallet()">Confirm Address</button>
        <p class="text-[9px] text-zinc-600 text-center font-bold uppercase tracking-widest mt-4">Make sure to use a TON network address</p>
    </div>

    <div id="wallet-success" class="hidden flex flex-col items-center">
        <div class="wallet-info-box">
            <div class="w-12 h-12 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-circle-check text-white text-xl"></i>
            </div>
            <h3 class="font-black text-sm uppercase mb-1">Wallet Submitted</h3>
            <p id="saved-addr-display" class="text-zinc-500 text-[10px] font-mono break-all px-4"></p>
        </div>
        <button class="mt-6 text-zinc-600 font-black text-[10px] uppercase underline" onclick="resetWallet()">Change Address</button>
    </div>
</div>

<script>
    // --- WALLET STORAGE LOGIC ---
    let userWallet = localStorage.getItem('koala_wallet_addr') || null;

    // Uygulama açıldığında cüzdanı kontrol et
    document.addEventListener('DOMContentLoaded', () => {
        if(userWallet) {
            showConnectedUI(userWallet);
        }
    });

    function saveWallet() {
        const input = document.getElementById('wallet-addr-input');
        const addr = input.value.trim();

        if(addr.length < 10) {
            alert("Please enter a valid TON address.");
            haptic('medium');
            return;
        }

        // Veriyi Kaydet (Tarayıcı hafızasına/LocalStorage)
        localStorage.setItem('koala_wallet_addr', addr);
        userWallet = addr;

        // UI Güncelle
        haptic('success');
        showConnectedUI(addr);
        
        // Ödül Puanı Ekle (Opsiyonel)
        balance += 500; 
        document.getElementById('balance').innerText = balance.toLocaleString();
    }

    function showConnectedUI(addr) {
        document.getElementById('wallet-form').classList.add('hidden');
        document.getElementById('wallet-success').classList.remove('hidden');
        
        // Adresin başını ve sonunu göster (Örn: UQAz...88x1)
        const display = addr.substring(0, 8) + "..." + addr.substring(addr.length - 8);
        document.getElementById('saved-addr-display').innerText = display;
    }

    function resetWallet() {
        localStorage.removeItem('koala_wallet_addr');
        userWallet = null;
        document.getElementById('wallet-form').classList.remove('hidden');
        document.getElementById('wallet-success').classList.add('hidden');
        haptic('light');
    }

    // --- HAPTIC (Hatırlatma) ---
    function haptic(type) {
        if (window.Telegram?.WebApp?.HapticFeedback) {
            if(type === 'light') window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
            if(type === 'medium') window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
            if(type === 'success') window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
        }
    }
</script>
