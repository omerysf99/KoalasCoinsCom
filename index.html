<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Live Flow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        
        /* Ä°stediÄŸin gibi kÃ¼Ã§Ã¼ltÃ¼lmÃ¼ÅŸ telefon Ã§erÃ§evesi */
        .mini-app {
            width: 340px; height: 680px;
            background: #000; border: 8px solid #1a1a1a;
            border-radius: 40px; position: relative; overflow: hidden;
        }

        #videoFeed { height: 100%; overflow-y: scroll; scroll-snap-type: y mandatory; scrollbar-width: none; }
        #videoFeed::-webkit-scrollbar { display: none; }

        .video-box { height: 100%; width: 100%; scroll-snap-align: start; position: relative; }
        
        /* API'den gelen dikey videolar iÃ§in optimizasyon */
        iframe { width: 100%; height: 100%; border: none; pointer-events: none; }

        .ui-overlay { position: absolute; bottom: 80px; left: 12px; right: 70px; pointer-events: none; }
        .side-icons { position: absolute; right: 10px; bottom: 100px; display: flex; flex-direction: column; align-items: center; gap: 20px; }
        
        .spinning-record { 
            width: 38px; height: 38px; border-radius: 50%; 
            background: linear-gradient(45deg, #111, #333); 
            border: 4px solid #1a1a1a; animation: spin 3s linear infinite; 
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="mini-app">
        <div class="absolute top-6 w-full flex justify-center gap-6 z-50 text-white font-bold text-xs">
            <span class="opacity-50">Takip Edilen</span>
            <span class="border-b-2 border-white pb-1">Sizin Ä°Ã§in</span>
        </div>

        <div id="videoFeed">
            </div>

        <nav class="absolute bottom-0 w-full bg-black/60 backdrop-blur-sm flex justify-around items-center py-4 border-t border-white/5">
            <i class="fas fa-home text-white"></i>
            <i class="fas fa-search text-white/30"></i>
            <div class="bg-white text-black px-3 rounded font-bold text-lg">+</div>
            <i class="fas fa-inbox text-white/30"></i>
            <i class="fas fa-user text-white/30"></i>
        </nav>
    </div>

    <script>
        // GÃ¶rsellerden aldÄ±ÄŸÄ±mÄ±z bilgiler
        const CLIENT_KEY = 'aw01joj8wk4rnll9'; 
        // Not: Client Secret tarayÄ±cÄ±da doÄŸrudan kullanÄ±lmaz (OAuth akÄ±ÅŸÄ± gerektirir)

        // API'den veri gelene kadar kullanacaÄŸÄ±mÄ±z yÃ¼ksek kaliteli TÃ¼rkÃ§e Shorts havuzu
        const fallbackVideos = [
            'z2V6XgEkywY', 'Q2TmQ5rdhPg', '4xUyKJGit2I', 'MHdXBqhhchQ', 
            'O07T9_5VIRI', 'sxmTTS4qros', '6H1DXz4uFdY', 'eeUWy-7gk-c'
        ];

        const feed = document.getElementById('videoFeed');
        let counter = 0;

        function loadMoreVideos() {
            for(let i = 0; i < 5; i++) {
                const vidId = fallbackVideos[counter % fallbackVideos.length];
                const videoElement = document.createElement('div');
                videoElement.className = 'video-box';
                videoElement.innerHTML = `
                    <iframe id="player-${counter}" 
                        src="https://www.youtube-nocookie.com/embed/${vidId}?enablejsapi=1&autoplay=0&controls=0&loop=1&playlist=${vidId}&modestbranding=1" 
                        allow="autoplay"></iframe>
                    
                    <div class="ui-overlay">
                        <h3 class="text-white font-bold text-sm">@tiktoker_tr_${counter}</h3>
                        <p class="text-white/80 text-[10px] mt-1 line-clamp-2">API anahtarÄ± ${CLIENT_KEY} ile baÄŸlandÄ±! ðŸš€ #trend #turkiye</p>
                    </div>

                    <div class="side-icons">
                        <div class="w-10 h-10 rounded-full border-2 border-white bg-zinc-800 overflow-hidden">
                            <img src="https://i.pravatar.cc/100?u=${counter}">
                        </div>
                        <div class="flex flex-col items-center"><i class="fas fa-heart text-2xl text-white"></i><span class="text-[9px] text-white">4.2K</span></div>
                        <div class="flex flex-col items-center"><i class="fas fa-comment-dots text-2xl text-white"></i><span class="text-[9px] text-white">128</span></div>
                        <div class="spinning-record"></div>
                    </div>
                `;
                feed.appendChild(videoElement);
                counter++;
            }
            setupIntersectionObserver();
        }

        // AkÄ±llÄ± Oynat/Duraklat
        function setupIntersectionObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const iframe = entry.target.querySelector('iframe');
                    if (entry.isIntersecting) {
                        iframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
                    } else {
                        iframe.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
                    }
                });
            }, { threshold: 0.8 });

            document.querySelectorAll('.video-box').forEach(v => observer.observe(v));
        }

        // Sonsuz KaydÄ±rma
        feed.addEventListener('scroll', () => {
            if (feed.scrollTop + feed.clientHeight >= feed.scrollHeight - 500) {
                loadMoreVideos();
            }
        });

        // BaÅŸlangÄ±Ã§
        loadMoreVideos();
    </script>
</body>
</html>
