<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sınırsız YouTube Shorts</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body, html { height: 100%; background-color: #000; overflow: hidden; font-family: sans-serif; }

        #shorts-wrapper {
            height: 100vh;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
            scrollbar-width: none; /* Firefox */
        }
        #shorts-wrapper::-webkit-scrollbar { display: none; } /* Chrome/Safari */

        .short-card {
            height: 100vh;
            width: 100%;
            scroll-snap-align: start;
            position: relative;
            background: #000;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            pointer-events: auto;
        }

        .overlay {
            position: absolute;
            bottom: 40px;
            left: 15px;
            right: 70px;
            color: white;
            z-index: 5;
            pointer-events: none;
            text-shadow: 1px 1px 5px rgba(0,0,0,0.8);
        }

        .channel-name { font-weight: bold; font-size: 1.1rem; margin-bottom: 8px; display: flex; align-items: center; }
        .video-title { font-size: 0.95rem; line-height: 1.4; opacity: 0.9; }

        .loader {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: white; font-size: 1.2rem; display: none;
        }
    </style>
</head>
<body>

    <div id="loader" class="loader">Videolar Yükleniyor...</div>
    <div id="shorts-wrapper"></div>

    <script>
        // Senin API Key'in
        const API_KEY = 'AIzaSyDkaygARzpXfIXlozjyppLdXsPoE-mq1gg';
        const wrapper = document.getElementById('shorts-wrapper');
        const loader = document.getElementById('loader');

        async function getVideos() {
            // 1. ÖNCE CACHE (HAFIZA) KONTROLÜ
            const cached = localStorage.getItem('yt_shorts_cache');
            const cacheTime = localStorage.getItem('yt_cache_time');
            
            // Eğer veriler 30 dakikadan yeniyse API'ye hiç sorma (Kota koruması)
            if (cached && cacheTime && (Date.now() - cacheTime < 1800000)) {
                console.log("Veriler hafızadan getirildi (Kota harcanmadı)");
                render(JSON.parse(cached));
                return;
            }

            // 2. KOTA DOSTU API ÇAĞRISI (Arama yapmaz, popülerleri çeker)
            // Bu metod sadece 1 kota birimi harcar!
            loader.style.display = 'block';
            try {
                const response = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet&chart=mostPopular&maxResults=20&regionCode=TR&videoCategoryId=42&key=${API_KEY}`);
                const data = await response.json();

                if (data.items) {
                    localStorage.setItem('yt_shorts_cache', JSON.stringify(data.items));
                    localStorage.setItem('yt_cache_time', Date.now());
                    render(data.items);
                } else {
                    wrapper.innerHTML = "<div style='color:white; padding:20px;'>Kota dolmuş veya API anahtarı geçersiz.</div>";
                }
            } catch (err) {
                console.error("Hata:", err);
            } finally {
                loader.style.display = 'none';
            }
        }

        function render(videos) {
            wrapper.innerHTML = '';
            videos.forEach(v => {
                const card = document.createElement('div');
                card.className = 'short-card';
                card.innerHTML = `
                    <div class="overlay">
                        <div class="channel-name">@${v.snippet.channelTitle}</div>
                        <div class="video-title">${v.snippet.title}</div>
                    </div>
                    <iframe 
                        src="https://www.youtube.com/embed/${v.id}?autoplay=0&controls=0&loop=1&playlist=${v.id}&modestbranding=1&rel=0" 
                        allow="autoplay; encrypted-media">
                    </iframe>
                `;
                wrapper.appendChild(card);
            });
        }

        // Başlat
        getVideos();
    </script>
</body>
</html>
