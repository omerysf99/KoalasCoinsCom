<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenTube - No API Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f0f0f; color: white; font-family: 'Roboto', sans-serif; }
        .v-card img { aspect-ratio: 16/9; border-radius: 12px; object-fit: cover; transition: 0.3s; }
        .v-card:hover img { border-radius: 0; }
        .video-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        #player-modal { display: none; background: rgba(0,0,0,0.9); position: fixed; inset: 0; z-index: 1000; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <nav class="sticky top-0 bg-[#0f0f0f] z-50 p-4 flex items-center justify-between border-b border-[#272727]">
        <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
            <span class="text-red-600 text-3xl font-bold">‚ñ∂</span>
            <span class="text-xl font-bold tracking-tighter">OpenTube</span>
        </div>
        <div class="flex w-1/2 max-w-[600px]">
            <input id="searchInput" type="text" placeholder="Kota sƒ±nƒ±rƒ± olmadan ara..." class="w-full bg-[#121212] border border-[#303030] rounded-l-full px-5 py-2 outline-none focus:border-red-600">
            <button onclick="app.search()" class="bg-[#222] border border-[#303030] border-l-0 px-6 rounded-r-full hover:bg-[#333]">üîç</button>
        </div>
    </nav>

    <main class="p-6">
        <div id="videoGrid" class="video-container">
            </div>
    </main>

    <div id="player-modal">
        <div class="w-full max-w-4xl p-4">
            <button onclick="app.closePlayer()" class="mb-2 bg-red-600 px-4 py-1 rounded font-bold">KAPAT</button>
            <div class="aspect-video bg-black">
                <iframe id="main-frame" class="w-full h-full" src="" frameborder="0" allowfullscreen></iframe>
            </div>
            <h2 id="video-title" class="text-xl font-bold mt-4"></h2>
        </div>
    </div>

    <script>
        const app = {
            // A√ßƒ±k kaynaklƒ± Invidious sunucusu (Eƒüer yava≈ülarsa invidious.io adresinden ba≈üka sunucu se√ßebilirsin)
            apiBase: 'https://invidious.sethforprivacy.com/api/v1',

            async fetchVideos(query) {
                const grid = document.getElementById('videoGrid');
                grid.innerHTML = '<p class="col-span-full text-center">Y√ºkleniyor...</p>';

                try {
                    // API anahtarƒ± yok! Doƒürudan arama yapƒ±yoruz.
                    const response = await fetch(`${this.apiBase}/search?q=${encodeURIComponent(query)}`);
                    const results = await response.json();
                    this.render(results);
                } catch (error) {
                    console.error("Veri √ßekilemedi:", error);
                    grid.innerHTML = '<p class="text-red-500">Sunucu me≈ügul, l√ºtfen az sonra tekrar dene.</p>';
                }
            },

            render(videos) {
                const grid = document.getElementById('videoGrid');
                grid.innerHTML = videos.map(v => `
                    <div class="v-card cursor-pointer group" onclick="app.play('${v.videoId}', '${v.title.replace(/'/g, "")}')">
                        <div class="relative">
                            <img src="${v.videoThumbnails[0].url}" class="w-full">
                            <span class="absolute bottom-2 right-2 bg-black/80 text-xs px-2 py-1 rounded">${v.lengthSeconds} sn</span>
                        </div>
                        <div class="mt-3">
                            <h3 class="font-bold text-sm line-clamp-2">${v.title}</h3>
                            <p class="text-xs text-gray-400 mt-1">${v.author} ‚Ä¢ ${v.viewCountText}</p>
                        </div>
                    </div>
                `).join('');
            },

            play(id, title) {
                const modal = document.getElementById('player-modal');
                const frame = document.getElementById('main-frame');
                const titleEl = document.getElementById('video-title');
                
                // YouTube'un kendi player'ƒ± yerine reklamsƒ±z embed kullanƒ±yoruz
                frame.src = `https://www.youtube.com/embed/${id}?autoplay=1`;
                titleEl.innerText = title;
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            },

            closePlayer() {
                const modal = document.getElementById('player-modal');
                document.getElementById('main-frame').src = "";
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            },

            search() {
                const q = document.getElementById('searchInput').value;
                if (q) this.fetchVideos(q);
            }
        };

        // ƒ∞lk a√ßƒ±lƒ±≈ü
        app.fetchVideos("pop√ºler m√ºzik t√ºrkiye");

        // Enter tu≈üu dinle
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') app.search();
        });
    </script>
</body>
</html>
