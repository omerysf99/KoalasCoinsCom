<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>KOALA ARCADE | PRO EDITION</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Inter:wght@400;700;900&display=swap');

        :root {
            --neon: #39ff14;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: #000; color: #fff; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        .sync { font-family: 'Syncopate', sans-serif; }

        /* Sayfa Yapƒ±sƒ± */
        .page { display: none; flex: 1; flex-direction: column; padding: 25px 20px 110px; overflow-y: auto; }
        .page.active { display: flex; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        /* Kart Stilleri */
        .card { background: var(--glass); border: 1px solid var(--border); border-radius: 24px; padding: 20px; margin-bottom: 12px; }
        .neon-border { border-color: var(--neon); box-shadow: 0 0 15px rgba(57, 255, 20, 0.1); }

        /* Combo Kartlarƒ± */
        .combo-grid { display: grid; grid-cols: 3; gap: 10px; margin-bottom: 20px; }
        .combo-slot { height: 80px; background: rgba(255,255,255,0.02); border: 2px dashed #222; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .combo-slot.filled { border-style: solid; border-color: var(--neon); color: var(--neon); }

        .item-card { background: #0a0a0a; border: 1px solid #1a1a1a; padding: 15px; border-radius: 20px; text-align: center; transition: 0.2s; }
        .item-card:active { transform: scale(0.95); background: #111; }

        /* Borsa Resimleri */
        .ex-img { width: 40px; height: 40px; border-radius: 10px; object-fit: cover; }
        
        /* Butonlar */
        .btn-main { background: #fff; color: #000; padding: 18px; border-radius: 22px; font-weight: 900; text-align: center; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; }
        .btn-claim { background: var(--neon); color: #000; padding: 8px 15px; border-radius: 12px; font-size: 11px; font-weight: 900; }

        /* Navigasyon */
        .nav-bar { position: fixed; bottom: 20px; left: 20px; right: 20px; height: 80px; background: rgba(10,10,10,0.9); backdrop-filter: blur(20px); border-radius: 25px; border: 1px solid var(--border); display: flex; z-index: 1000; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #444; font-size: 10px; font-weight: 800; gap: 4px; }
        .nav-item.active { color: var(--neon); }

        .koala-box { width: 160px; height: 160px; margin: 0 auto; border-radius: 40px; overflow: hidden; border: 4px solid #111; }
        .koala-box img { width: 100%; height: 100%; object-fit: cover; }

        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

<div id="app" class="h-full flex flex-col">

    <div id="p-home" class="page active">
        <div class="flex justify-between items-center mb-6">
            <div class="flex items-center gap-2 bg-[#111] px-4 py-2 rounded-full border border-white/5">
                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                <span class="text-[10px] font-black tracking-widest uppercase">Live Alpha</span>
            </div>
            <i class="fa-solid fa-gear text-zinc-700"></i>
        </div>

        <div class="text-center mb-8">
            <p class="sync text-[10px] text-zinc-500 mb-1 uppercase tracking-[4px]">Balance</p>
            <h1 id="bal-txt" class="sync text-5xl font-bold tracking-tighter">0.00</h1>
        </div>

        <div class="card neon-border">
            <div class="flex justify-between items-center mb-4">
                <p class="sync text-[11px] text-white">Daily Combo</p>
                <span id="combo-status" class="text-[9px] font-bold text-zinc-500">0/3 SE√áƒ∞LDƒ∞</span>
            </div>
            <div class="grid grid-cols-3 gap-2 mb-4">
                <div id="slot-0" class="combo-slot">?</div>
                <div id="slot-1" class="combo-slot">?</div>
                <div id="slot-2" class="combo-slot">?</div>
            </div>
            <p class="text-[9px] text-zinc-500 text-center uppercase font-bold">Doƒüru 3 kartƒ± bul ve 50.00 $KOALA kazan!</p>
        </div>

        <div class="space-y-3">
            <div class="card flex justify-between items-center !py-4" onclick="watchAd()">
                <div class="flex items-center gap-4">
                    <div class="w-10 h-10 bg-white/5 rounded-xl flex items-center justify-center"><i class="fa-solid fa-play text-xs"></i></div>
                    <div><p class="font-black text-xs uppercase">Video Ad</p><p class="text-[9px] text-zinc-500 font-bold">+1.00 $KOALA</p></div>
                </div>
                <div class="btn-claim">ƒ∞ZLE</div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="item-card" onclick="selectCombo(0, 'üçå')">
                    <span class="text-2xl">üçå</span>
                    <p class="text-[10px] font-bold mt-2">Banana</p>
                </div>
                <div class="item-card" onclick="selectCombo(1, 'ü••')">
                    <span class="text-2xl">ü••</span>
                    <p class="text-[10px] font-bold mt-2">Coconut</p>
                </div>
                <div class="item-card" onclick="selectCombo(2, 'üå≥')">
                    <span class="text-2xl">üå≥</span>
                    <p class="text-[10px] font-bold mt-2">Eucalyptus</p>
                </div>
                <div class="item-card" onclick="selectCombo(3, 'üíé')">
                    <span class="text-2xl">üíé</span>
                    <p class="text-[10px] font-bold mt-2">Diamond</p>
                </div>
            </div>
        </div>
    </div>

    <div id="p-ref" class="page">
        <h2 class="sync text-3xl font-bold mt-6 mb-2">FRIENDS</h2>
        <p class="text-zinc-500 text-xs font-bold mb-10 uppercase tracking-widest">Davet et, birlikte kazan.</p>

        <div class="card text-center py-10 bg-gradient-to-b from-white/5 to-transparent">
            <p class="text-[10px] text-zinc-500 font-black uppercase mb-2">Davet Ba≈üƒ±na Bonus</p>
            <h3 class="sync text-4xl font-bold">+10,000</h3>
            <p class="text-[9px] text-zinc-600 font-bold mt-4 uppercase">Sƒ±nƒ±r yok, ne kadar √ßok arkada≈ü o kadar √ßok Koala!</p>
        </div>

        <div class="flex-1 mt-6 overflow-y-auto pr-2" id="ref-list">
            </div>

        <div onclick="shareRef()" class="btn-main mt-4">Arkada≈ülarƒ±nƒ± √áaƒüƒ±r</div>
    </div>

    <div id="p-airdrop" class="page">
        <h2 class="sync text-3xl font-bold mt-6 mb-8">AIRDROP</h2>
        
        <div class="mb-10">
            <h3 class="text-zinc-600 font-black text-[10px] uppercase mb-4 tracking-widest">Borsa Entegrasyonu</h3>
            <div class="space-y-3">
                <div class="card flex items-center justify-between !py-4" id="ex-Binance" onclick="setEx('Binance')">
                    <div class="flex items-center gap-4"><img src="binance.jpg" class="ex-img grayscale"><span class="sync text-[10px]">Binance</span></div>
                    <i class="fa-solid fa-circle-check text-zinc-900"></i>
                </div>
                <div class="card flex items-center justify-between !py-4" id="ex-OKX" onclick="setEx('OKX')">
                    <div class="flex items-center gap-4"><img src="okx.jpg" class="ex-img grayscale"><span class="sync text-[10px]">OKX</span></div>
                    <i class="fa-solid fa-circle-check text-zinc-900"></i>
                </div>
                <div class="card flex items-center justify-between !py-4" id="ex-Bitget" onclick="setEx('Bitget')">
                    <div class="flex items-center gap-4"><img src="bitget.jpg" class="ex-img grayscale"><span class="sync text-[10px]">Bitget</span></div>
                    <i class="fa-solid fa-circle-check text-zinc-900"></i>
                </div>
            </div>
        </div>

        <h3 class="text-zinc-600 font-black text-[10px] uppercase mb-4 tracking-widest">Status</h3>
        <div class="card border-dashed">
            <p class="text-[10px] text-zinc-500 font-bold uppercase mb-1">Listeleme Durumu</p>
            <p class="text-xs font-black text-white italic">BEKLEMEDE (PHASE 1)</p>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="tab('home', this)"><i class="fa-solid fa-coins"></i><span>KAZAN</span></div>
        <div class="nav-item" onclick="tab('ref', this)"><i class="fa-solid fa-users"></i><span>FRIENDS</span></div>
        <div class="nav-item" onclick="tab('airdrop', this)"><i class="fa-solid fa-parachute-box"></i><span>AIRDROP</span></div>
    </nav>
</div>

<script>
    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyAJbCj95zZf2VTGH196clZpu5nYm47ESpY",
        authDomain: "koalascombom.firebaseapp.com",
        projectId: "koalascombom",
        storageBucket: "koalascombom.firebasestorage.app",
        messagingSenderId: "533011982418",
        appId: "1:533011982418:web:9e8e50e93a99017062d78b"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // State
    let uid = localStorage.getItem('k_uid') || 'ID' + Math.floor(Math.random()*90000+10000);
    localStorage.setItem('k_uid', uid);

    let u = {
        bal: 0,
        ex: '',
        refs: [],
        combo: [], // Mevcut se√ßilenler
        comboDone: false // Bug√ºn tamamladƒ± mƒ±?
    };

    // Doƒüru Combo ≈ûifresi (Sistem her g√ºn bunu deƒüi≈ütirebilir)
    const CORRECT_COMBO = ['üçå', 'üå≥', 'üíé'];

    async function load() {
        const doc = await db.collection("users").doc(uid).get();
        if(doc.exists) u = {...u, ...doc.data()};
        render();
    }

    function watchAd() {
        u.bal += 1.0;
        save(); render();
        alert("Success! +1.00 Koala");
    }

    function selectCombo(idx, emoji) {
        if(u.comboDone) return alert("Bug√ºnk√º combo √∂d√ºl√ºn√º zaten aldƒ±n!");
        if(u.combo.length >= 3) u.combo = []; // Sƒ±fƒ±rla
        
        u.combo.push(emoji);
        render();

        if(u.combo.length === 3) {
            checkCombo();
        }
    }

    function checkCombo() {
        const isCorrect = JSON.stringify(u.combo) === JSON.stringify(CORRECT_COMBO);
        if(isCorrect) {
            u.bal += 50.0;
            u.comboDone = true;
            alert("TEBRƒ∞KLER! Doƒüru Combo. +50.00 $KOALA kazandƒ±n.");
        } else {
            alert("Yanlƒ±≈ü dizilim! Tekrar dene.");
            u.combo = [];
        }
        save(); render();
    }

    function setEx(name) { u.ex = name; save(); render(); }

    function shareRef() {
        const link = window.location.origin + "?ref=" + uid;
        navigator.clipboard.writeText(link);
        alert("Referans linki kopyalandƒ±! Arkada≈üƒ±na g√∂nder.");
    }

    function render() {
        // Bakiye
        document.getElementById('bal-txt').innerText = u.bal.toLocaleString('tr-TR', {minimumFractionDigits: 2});
        
        // Combo UI
        for(let i=0; i<3; i++) {
            const slot = document.getElementById('slot-' + i);
            if(u.combo[i]) {
                slot.innerText = u.combo[i];
                slot.classList.add('filled');
            } else {
                slot.innerText = '?';
                slot.classList.remove('filled');
            }
        }
        document.getElementById('combo-status').innerText = `${u.combo.length}/3 SE√áƒ∞LDƒ∞`;

        // Borsa UI
        document.querySelectorAll('.ex-img').forEach(img => img.classList.add('grayscale'));
        document.querySelectorAll('.fa-circle-check').forEach(i => i.style.color = '#111');
        if(u.ex) {
            const card = document.getElementById('ex-' + u.ex);
            card.querySelector('img').classList.remove('grayscale');
            card.querySelector('i').style.color = '#39ff14';
        }

        // Ref List
        let rH = '';
        u.refs.forEach(r => {
            rH += `<div class="card !py-3 flex justify-between items-center opacity-60">
                <span class="text-[10px] font-bold">Ref: ${r}</span>
                <span class="text-[10px] text-[#39ff14] font-black">+10,000</span>
            </div>`;
        });
        document.getElementById('ref-list').innerHTML = rH || '<p class="text-center py-10 text-[10px] text-zinc-800 font-bold uppercase">Hen√ºz arkada≈üƒ±n yok</p>';
    }

    async function save() { await db.collection("users").doc(uid).set(u); }

    function tab(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('p-' + id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    }

    window.onload = load;
</script>
</body>
</html>
